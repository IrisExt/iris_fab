{% extends 'cvPersonne/menubloc.html.twig' %}
{% block stylesheets %}
    <!-- CSS -->
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/alertifyjs@1.13.1/build/css/alertify.min.css"/>
    <!-- Bootstrap theme -->
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/alertifyjs@1.13.1/build/css/themes/bootstrap.min.css"/>
    <!-- modals CSS
        ============================================ -->
    <link rel="stylesheet" href="{{ asset('css/modals.css') }}">
    <link rel="stylesheet" href="{{ asset('css/datapicker/datepicker3.css') }}">
{% endblock %}
    {% block style_menu_cv %}
<style>
    .tab th {
        background-color: #369;
        color: white;
    }
</style>
{% endblock %}

   {% block titre_cv %}Poste(s) antérieur(s){% endblock %}
{% block cv %}

    <div class="col-lg-12">

            <div class="text-right">
                <p>
                    <button type="button" class="ajoute_poste btn btn-primary  btn-xs" data-toggle="modal" data-target="#ajouterPoste" data-id="{{ path('cv_add_autre_activ') }}"><i class="fa fa-plus"></i>
                        Ajouter un poste antérieur
                    </button>
                </p>
            </div>
        <div class="table-responsive">
            <table class="table table-striped table-bordered" id="user_data">
                <tr class="tab">
                    <th colspan="col">De</th>
                    <th colspan="col">A</th>
                    <th colspan="col">Nom de l'organisme</th>
                    <th colspan="col">Ville</th>
                    <th colspan="col">Fonctions</th>
                    <th colspan="col">Action</th>
                </tr>
                {% for poste in postes %}
                    <tr>
                <td>{{ poste.dtDebut|date('Y') }}</td>
                <td>{{ poste.dtFin|date('Y') }}</td>
                <td>{{ poste.idOrganisme.lbNomFr }}</td>

                <td>{{ poste.idOrganisme.ville }}</td>
                <td>{{ poste.idFonction }}</td>
                <td>
                    <a href="#" id="update_poste"  data-toggle="modal" data-target="#updatePoste" data-id="{{ path('cv_update_autre_activ', {'idOrganisme' : poste.idOrganisme.idOrganisme}) }}" ><span class ="fa fa-edit"></span></a> |
                    <a href="#"  data-toggle="modal" id="delete_Poste" data-target="#deleteLangue"  data-id="{{ path('cv_delete_autre_activ', {'idOrganisme' : poste.idOrganisme.idOrganisme}) }}" ><span class ="fa fa-trash-o text-danger"></span></a>
                </td>

                    </tr>
                {% endfor %}

            </table>
            <!-- Modal modif -->   {% include 'cvPersonne/blocs/autres_activites/modal/addPostes.html.twig' %}
            <!-- Modal modif -->   {% include 'cvPersonne/blocs/autres_activites/modal/updatePostes.html.twig' %}
            <!-- Modal delete-->   {% include 'cvPersonne/blocs/tg_competence_langue/deleteLangue.html.twig' %}

        </div>
    </div>


{% endblock %}

{% block javascripts1 %}
    <script src="{{ asset('js/datapicker/bootstrap-datepicker.js') }}"></script>
    <script src="{{ asset('js/datapicker/datepicker-active.js') }}"></script>


    <script src="//cdn.jsdelivr.net/npm/alertifyjs@1.13.1/build/alertify.min.js"></script>
<script>

    $(document).ready(function () {
        $(document).on("click", ".ajoute_poste", function () {
            var path = $(this).data('id');
            // AJAX request
            $.ajax({
                url: path,
                type: 'post',
                success: function(response){
                    // Add response in Modal body
                    $('.modal-body').html(response);
                    // Display Modal
                    $('#ajouterPoste').modal('show');

                    $('#data_periode .input-daterange').datepicker({
                        startDate: '1970',
                        endDate: 'now',
                        minViewMode: "years",
                        viewMode: "years",
                        // keyboardNavigation: false,
                        // forceParse: false,
                        // autoclose: true,
                        // showOnFocus: true,
                        format: "yyyy",
                        language: 'fr'

                    });
                },
                error: function (XMLHttpRequest, textStatus, errorThrown) {
                    alert('Error : ' + errorThrown);
                }
            });


        });
        $(document).on("click", "#update_poste", function () {
            var path = $(this).data('id');
            // AJAX request
            $.ajax({
                url: path,
                type: 'post',
                success: function(response){
                    // Add response in Modal body
                    $('.modal-body').html(response);
                    // Display Modal
                    $('#updatePoste').modal('show');
                    $('#data_periode .input-daterange').datepicker({
                        startDate: '1970',
                        endDate: 'now',
                        minViewMode: "years",
                        viewMode: "years",
                        keyboardNavigation: false,
                        forceParse: false,
                        autoclose: true,
                        showOnFocus: true,
                        format: "yyyy",
                        language: 'fr'

                    });
                },
                error: function (XMLHttpRequest, textStatus, errorThrown) {
                    alert('Error : ' + errorThrown);
                }
            });
        });

        $(document).on("click", "#delete_Poste", function () {
            var path =  $(this).data('id');
            // AJAX request
            $.ajax({
                url: path,
                type: 'delete',
                success: function(response){
                    // Add response in Modal body
                    $('.modal-body').html(response);
                    // Display Modal
                    $('#deleteLangue').modal('show');
                },
                error: function (XMLHttpRequest, textStatus, errorThrown) {
                    alert('Error : ' + errorThrown);
                }
            });
        });
        $(document).on("click", ".submit", function () {

            if($('#tg_poste_dtDebut').val() > $('#tg_poste_dtFin').val()){
                alertify.alert('<i class="fa fa-exclamation-triangle text-danger" aria-hidden="true"> Erreur </i>',' Date début supérieur à la date fin');
                return false
            }

        });
        // $(document).on("click", ".modif", function () {

            $("#tg_poste_dtDebut").on("input", function(){
                // alert($(this).val());
                $("#result").text($(this).val());
            });
            // alert($('#tg_poste_dtDebut').val());
            //
            //
            //
            // if($('#tg_poste_dtDebut').val() > $('#tg_poste_dtFin').val()){
            //     alertify.alert('<i class="fa fa-exclamation-triangle text-danger" aria-hidden="true"> Erreur </i>',' Date début supérieur à la date fin');
            //     return false
            // }

        });
    // });
</script>
{% endblock %}

