{% extends 'base.html.twig' %}

{% block stylesheets %}
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.min.css">
    <link rel="stylesheet" type="text/css" href="{{ asset('css/duallistbox/bootstrap-duallistbox.min.css') }}">
    <style>
        .duallistbox{
            width: 100%;
        }
        .form-group .col-sm-3 {
            width: 0px;
        }
        .form-group  .col-sm-6 {
            width: 100%;
        }
        .tooltip{
            max-width:200%;
            padding:5px;
            min-height:2px;
            background:#000;/*change accordingly*/
        }
    </style>
{% endblock %}
{% block body %}
    <div class="container-fluid">
        <div class="row">
            {#        <div class="col-lg-">#}
            {#        </div>#}
            <div class="col-lg-12">
                <div class="sparkline8-list shadow-reset">
                    <div class="sparkline8-hd" style="background: #b7b8e1">
                        <div class="main-sparkline8-hd">
                            <h1>Modifier Formulaires</h1>
                            <div class="sparkline8-outline-icon">
                                <a href="{{ path('index_soumission') }}">{{ 'action.list'|trans }}</a>
                            </div>
                        </div>
                    </div>
                    <div class="sparkline8-graph">
                        <div class="text-right">
                            <a href="#" class="text-right"  data-toggle="collapse" data-target="#collapseExample" aria-expanded="false" aria-controls="collapseExample">
                                visualisation Blocs
                            </a>
                        </div>
                        <section>
                            <div class="collapse" id="collapseExample">
                                {% for bloc in blocs %}
                                    <td><a href="#" class="btn btn-light" data-id="{{ bloc.idbloc }}" data-toggle="modal" data-target="#imageModal"><span class="fa fa-image"></span> {{ bloc.lbbloc }}</a> </td>
                                {% endfor %}
                            </div>
                        </section>
                        {{ form_start(form) }}
                        <table class="table">
                            <tr>
                                <label class="col-form-label col-sm-8 required" for="formulaire_lbformulaire"> Libellé Formulaire </label>
                                <div class="col-sm-6"> {{ form_widget(form) }}</div>
                            </tr>
                            <tr>
                                <td>
                                    {{ form_widget(form) }}

                                    <select id="lbbloc_lbbloc" multiple="multiple" size="10"  name="bloc[lbbloc][]" >
                                        {% for bloc in blocs %}
                                            {#                                                {% if bloc.idbloc in [1 , 2] %}#}
                                            {#                                                    {% set selected = 'selected' %}#}
                                            {#                                                {% endif %}#}
                                            {#                                                <option  value="{{ bloc.idbloc }}" {{ selected }}> {{ bloc.lbbloc }}  </option><br>#}
                                            <option  value="{{ bloc.idbloc }}">   {{ bloc.lbbloc }}  </option><br>
                                            {#                                                {% set selected = '' %}#}
                                        {% endfor %}
                                    </select>
                                </td>
                            </tr>
                        </table>
                        <input type="hidden" name="DataFrom" value="null" id="setState">
                        <button type="submit" class="btn btn-primary btn-block">Créer formulaire</button>
                        {{ form_end(form) }}
                        {#                        </form>#}
                    </div>
                </div>
            </div>
        </div>
    </div>
    {% include 'soumission/modalImage/modalVisu.html.twig' %}
    {% block javascripts1 %}
        <script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"></script>
        <script src="{{ asset('js/duallistbox/jquery.bootstrap-duallistbox.js') }}"></script>

        <script>

            var demo1= $('.demo1').bootstrapDualListbox({

                // nonSelectedFilter: 'ion ([7-9]|[1][0-2])',
                nonSelectedListLabel: 'Non-selected',
                selectedListLabel: 'Selected',
                preserveSelectionOnMove: 'moved',
                moveOnSelect: false,
            });



            var demo1 = $('select[name="bloc[lbbloc][]"]').bootstrapDualListbox({
                nonSelectedListLabel: 'Blocs',
                selectedListLabel: 'Formulaires pour l\'appel',
                preserveSelectionOnMove: 'moved',
                moveOnSelect: false,
                selectorMinimalHeight: 170,
                showFilterInputs: false,
                filterTextClear: 'show all',
                filterPlaceHolder: 'Filter',
                moveSelectedLabel: 'Move selected',
                moveAllLabel: 'Move all',
                removeSelectedLabel: 'Remove selected',
                removeAllLabel: 'supprimer tous',
                infoText: '{0} Blocs ',
                infoTextEmpty: 'Formulaire vide',

            });
            $(function () {
                $('[data-toggle=tooltip]').tooltip();
            });
            $('[name="formulaire"]').submit(function() {
                var formBox = $('[name="bloc[lbbloc][]"]').val();
                $(function(){
                    $('#setState').val(formBox);
                });
                $( '[name="formulaire"]').submit(); //and here submit your form
                return false;
            });

            $('#imageModal').on('show.bs.modal', function (e) {
                    var id = $(e.relatedTarget).data('id');
                    var image = '<img id="myImg" src="/img/bloc/'+ id +'.JPG"  style="width:200%;max-width:100%">';
                    document.getElementById("visuImage").innerHTML = image;
                }
            );


        </script>
    {% endblock %}
{% endblock %}

